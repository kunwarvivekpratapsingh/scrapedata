<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Eval Report — single_question_result</title>
  <style>
    :root {
        --green:    #22c55e;
        --green-bg: #dcfce7;
        --green-fg: #166534;
        --red:      #ef4444;
        --red-bg:   #fee2e2;
        --red-fg:   #991b1b;
        --blue-bg:  #dbeafe;
        --blue-fg:  #1e40af;
        --amber-bg: #fef3c7;
        --amber-fg: #92400e;
        --gray-50:  #f9fafb;
        --gray-100: #f3f4f6;
        --gray-200: #e5e7eb;
        --gray-500: #6b7280;
        --gray-700: #374151;
        --gray-900: #111827;
        --bg-code:  #1e1e2e;
        --fg-code:  #cdd6f4;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
        font-family: system-ui, -apple-system, sans-serif;
        font-size: 14px;
        color: var(--gray-900);
        background: var(--gray-50);
        line-height: 1.5;
    }

    .page-wrap { max-width: 980px; margin: 0 auto; padding: 24px 16px 64px; }

    /* ── Header ── */
    .page-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 20px 24px;
        background: white;
        border: 1px solid var(--gray-200);
        border-radius: 10px;
        margin-bottom: 20px;
    }
    .page-header h1 { font-size: 1.5rem; font-weight: 700; color: var(--gray-900); }
    .header-meta { color: var(--gray-500); font-size: 0.85rem; margin-top: 4px; }
    .pass-rate-badge {
        padding: 10px 20px;
        border-radius: 999px;
        font-size: 1.1rem;
        font-weight: 700;
    }
    .pass-rate-badge.ok  { background: var(--green-bg); color: var(--green-fg); }
    .pass-rate-badge.bad { background: var(--red-bg);   color: var(--red-fg); }

    /* ── Section ── */
    .section { margin-bottom: 20px; }
    .section-title {
        font-size: 1rem;
        font-weight: 600;
        color: var(--gray-700);
        margin-bottom: 10px;
        padding-bottom: 6px;
        border-bottom: 2px solid var(--gray-200);
    }

    /* ── Summary cards ── */
    .cards-row {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
        gap: 12px;
    }
    .card {
        background: white;
        border: 1px solid var(--gray-200);
        border-radius: 8px;
        padding: 14px 16px;
    }
    .card-label { font-size: 0.75rem; color: var(--gray-500); text-transform: uppercase; letter-spacing: 0.05em; }
    .card-value { font-size: 1.6rem; font-weight: 700; margin-top: 4px; }
    .card-value.green { color: var(--green); }
    .card-value.red   { color: var(--red); }
    .card-value.blue  { color: #3b82f6; }

    /* ── Difficulty table ── */
    .breakdown-table {
        width: 100%;
        border-collapse: collapse;
        background: white;
        border: 1px solid var(--gray-200);
        border-radius: 8px;
        overflow: hidden;
    }
    .breakdown-table th {
        background: var(--gray-100);
        padding: 8px 14px;
        text-align: left;
        font-size: 0.8rem;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        color: var(--gray-500);
    }
    .breakdown-table td { padding: 10px 14px; border-top: 1px solid var(--gray-200); }

    /* ── Badges ── */
    .badge {
        display: inline-block;
        padding: 2px 9px;
        border-radius: 999px;
        font-size: 0.72rem;
        font-weight: 600;
        white-space: nowrap;
    }
    .badge-easy   { background: var(--green-bg); color: var(--green-fg); }
    .badge-medium { background: var(--amber-bg); color: var(--amber-fg); }
    .badge-hard   { background: var(--red-bg);   color: var(--red-fg); }
    .badge-ok     { background: var(--green-bg); color: var(--green-fg); }
    .badge-fail   { background: var(--red-bg);   color: var(--red-fg); }
    .badge-layer  { background: var(--blue-bg);  color: var(--blue-fg); font-size: 0.7rem; }
    .badge-iter-ok   { background: var(--green-bg); color: var(--green-fg); }
    .badge-iter-fail { background: var(--red-bg);   color: var(--red-fg); }

    /* ── Question accordion ── */
    details.q-accordion {
        background: white;
        border: 1px solid var(--gray-200);
        border-radius: 8px;
        margin-bottom: 10px;
        overflow: hidden;
    }
    details.q-accordion.q-ok   > summary { border-left: 4px solid var(--green); }
    details.q-accordion.q-fail > summary { border-left: 4px solid var(--red); }

    details.q-accordion > summary {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 12px 16px;
        cursor: pointer;
        user-select: none;
        list-style: none;
        flex-wrap: wrap;
    }
    details.q-accordion > summary::-webkit-details-marker { display: none; }
    details.q-accordion[open] > summary { background: var(--gray-50); }

    .q-id    { font-weight: 700; color: var(--gray-500); min-width: 32px; }
    .q-text  { flex: 1; font-weight: 500; }
    .q-iters { font-size: 0.75rem; color: var(--gray-500); margin-left: auto; }

    .q-body { padding: 16px; border-top: 1px solid var(--gray-200); }

    /* ── Answer / Error box ── */
    .answer-box {
        border-radius: 6px;
        padding: 12px 14px;
        margin-bottom: 14px;
        font-family: monospace;
        font-size: 0.85rem;
        white-space: pre-wrap;
        word-break: break-all;
    }
    .answer-box.ok   { background: #f0fdf4; border: 1px solid #bbf7d0; color: #166534; }
    .answer-box.fail { background: #fef2f2; border: 1px solid #fecaca; color: #991b1b; }

    /* ── Timeline ── */
    .timeline { margin-bottom: 14px; }
    .timeline-label { font-size: 0.75rem; font-weight: 600; color: var(--gray-500); text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 6px; }
    .timeline-strip { display: flex; flex-wrap: wrap; align-items: center; gap: 4px; }
    .tl-arrow { color: var(--gray-500); font-size: 0.8rem; }

    .tl-badge {
        display: inline-block;
        padding: 3px 10px;
        border-radius: 999px;
        font-size: 0.75rem;
        font-weight: 600;
        cursor: default;
        white-space: nowrap;
    }
    .tl-builder      { background: var(--blue-bg);  color: var(--blue-fg); }
    .tl-builder-fail { background: #fce7f3; color: #9d174d; }
    .tl-critic-ok    { background: var(--green-bg); color: var(--green-fg); }
    .tl-critic-fail  { background: var(--red-bg);   color: var(--red-fg); }
    .tl-exec-ok      { background: var(--green-bg); color: var(--green-fg); }
    .tl-exec-fail    { background: var(--red-bg);   color: var(--red-fg); }
    .tl-unknown      { background: var(--gray-100); color: var(--gray-700); }

    /* ── Iteration accordion ── */
    details.iter-block {
        border: 1px solid var(--gray-200);
        border-radius: 6px;
        margin-bottom: 8px;
        overflow: hidden;
        background: var(--gray-50);
    }
    details.iter-block > summary {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 9px 14px;
        cursor: pointer;
        user-select: none;
        list-style: none;
        font-weight: 600;
        font-size: 0.85rem;
    }
    details.iter-block > summary::-webkit-details-marker { display: none; }
    details.iter-block[open] > summary { background: var(--gray-100); }
    .iter-body { padding: 14px; border-top: 1px solid var(--gray-200); background: white; }

    /* ── Critic block ── */
    .critic-block { margin-bottom: 12px; }
    .critic-reasoning {
        font-size: 0.85rem;
        color: var(--gray-700);
        margin-bottom: 8px;
        padding: 8px 12px;
        background: var(--gray-50);
        border-radius: 4px;
        border-left: 3px solid var(--gray-200);
    }

    details.sub-block {
        border: 1px solid var(--gray-200);
        border-radius: 4px;
        margin-top: 6px;
        background: white;
    }
    details.sub-block > summary {
        padding: 6px 10px;
        cursor: pointer;
        user-select: none;
        list-style: none;
        font-size: 0.8rem;
        font-weight: 600;
        color: var(--gray-700);
    }
    details.sub-block > summary::-webkit-details-marker { display: none; }
    .sub-block-body { padding: 8px 12px; border-top: 1px solid var(--gray-200); }
    .error-list, .suggest-list {
        padding-left: 18px;
        font-size: 0.82rem;
        color: var(--red-fg);
    }
    .suggest-list { color: var(--amber-fg); }
    .error-list li, .suggest-list li { margin-bottom: 4px; }

    /* ── DAG section ── */
    .dag-section { margin-top: 10px; }
    .dag-description {
        font-size: 0.82rem;
        color: var(--gray-500);
        font-style: italic;
        margin-bottom: 10px;
    }
    .dag-failed {
        padding: 10px 14px;
        background: #fff7ed;
        border: 1px solid #fed7aa;
        border-radius: 6px;
        color: #9a3412;
        font-family: monospace;
        font-size: 0.82rem;
        white-space: pre-wrap;
    }

    /* ── DAG node card ── */
    .dag-node {
        border: 1px solid var(--gray-200);
        border-radius: 6px;
        margin-bottom: 8px;
        overflow: hidden;
    }
    .dag-node-header {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 12px;
        background: var(--gray-100);
        flex-wrap: wrap;
    }
    .node-id     { font-family: monospace; font-weight: 700; font-size: 0.85rem; }
    .output-type { font-size: 0.72rem; color: var(--gray-500); font-family: monospace; margin-left: auto; }
    .dag-node-operation {
        padding: 6px 12px;
        font-size: 0.82rem;
        color: var(--gray-700);
        font-style: italic;
        border-bottom: 1px solid var(--gray-200);
    }
    .dag-node-inputs {
        padding: 6px 12px;
        font-size: 0.82rem;
        color: var(--gray-700);
        border-bottom: 1px solid var(--gray-200);
    }
    .dag-node-inputs ul { padding-left: 16px; margin-top: 2px; }
    .dag-node-inputs li { font-family: monospace; font-size: 0.8rem; color: var(--gray-500); }
    .dag-node-inputs li code { color: var(--gray-700); }

    /* ── Code block ── */
    pre.code-block {
        background: var(--bg-code);
        color: var(--fg-code);
        padding: 14px 16px;
        overflow-x: auto;
        font-family: 'Cascadia Code', 'Fira Code', 'Consolas', monospace;
        font-size: 0.82rem;
        line-height: 1.65;
        margin: 0;
    }
    .hl-kw { color: #cba6f7; }   /* purple  — keywords */
    .hl-bi { color: #89dceb; }   /* cyan    — builtins */
    .hl-st { color: #a6e3a1; }   /* green   — strings */
    .hl-cm { color: #6c7086; }   /* gray    — comments */

    /* ── Edges ── */
    .edges-row {
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
        padding: 8px 12px;
        font-family: monospace;
        font-size: 0.8rem;
        color: var(--gray-700);
        border-top: 1px solid var(--gray-200);
        background: var(--gray-50);
    }
    .edge-item { background: var(--blue-bg); color: var(--blue-fg); padding: 2px 8px; border-radius: 4px; }
    .final-node-label {
        padding: 6px 12px;
        font-size: 0.8rem;
        color: var(--gray-500);
        border-top: 1px solid var(--gray-200);
    }
    .final-node-label code { font-weight: 600; color: var(--gray-700); }

    /* ── DAG SVG visualizer ── */
    .dag-svg-wrap {
        border: 1px solid var(--gray-200);
        border-radius: 6px;
        padding: 14px 16px;
        background: var(--gray-50);
        margin-bottom: 12px;
        overflow-x: auto;
    }
    .dag-svg-title {
        font-size: 0.75rem;
        font-weight: 600;
        color: var(--gray-500);
        text-transform: uppercase;
        letter-spacing: 0.05em;
        margin-bottom: 8px;
    }

    /* ── Node outputs table ── */
    .outputs-section { margin-top: 14px; }
    .outputs-section strong { font-size: 0.82rem; color: var(--gray-700); display: block; margin-bottom: 6px; }
    .outputs-table {
        width: 100%;
        border-collapse: collapse;
        border: 1px solid var(--gray-200);
        border-radius: 6px;
        overflow: hidden;
        font-size: 0.82rem;
    }
    .outputs-table th {
        background: var(--gray-100);
        padding: 6px 12px;
        text-align: left;
        font-weight: 600;
        color: var(--gray-700);
    }
    .outputs-table td { padding: 8px 12px; border-top: 1px solid var(--gray-200); vertical-align: top; }
    .outputs-table td:first-child { font-family: monospace; font-weight: 600; color: #3b82f6; white-space: nowrap; }
    .outputs-table pre { background: none; color: var(--gray-700); font-size: 0.8rem; white-space: pre-wrap; word-break: break-all; }
    .no-outputs { font-size: 0.82rem; color: var(--gray-500); font-style: italic; padding: 8px 0; }
</style>
</head>
<body>
<div class="page-wrap">

<div class="page-header">
  <div>
    <h1>Eval Report</h1>
    <div class="header-meta">
      Dataset: <strong>single_question_result</strong>
      &nbsp;·&nbsp; Generated: 2026-02-19 11:49:13
    </div>
  </div>
  <div class="pass-rate-badge ok">100.0% Pass Rate</div>
</div>

<div class="section">
  <div class="section-title">Summary</div>
  <div class="cards-row"><div class="card">
  <div class="card-label">Total Questions</div>
  <div class="card-value blue">1</div>
</div><div class="card">
  <div class="card-label">Pass Rate</div>
  <div class="card-value green">100.0%</div>
</div><div class="card">
  <div class="card-label">Passed</div>
  <div class="card-value green">1</div>
</div><div class="card">
  <div class="card-label">Failed</div>
  <div class="card-value ">0</div>
</div><div class="card">
  <div class="card-label">Critic Exhausted</div>
  <div class="card-value ">0</div>
</div></div>
</div>

<div class="section">
  <div class="section-title">Difficulty Breakdown</div>
  <table class="breakdown-table">
    <thead><tr><th>Difficulty</th><th>Total</th><th>Passed</th><th>Failed</th><th>Pass Rate</th></tr></thead>
    <tbody><tr>
  <td><span class="badge badge-easy">easy</span></td>
  <td>0</td>
  <td style="color:var(--green-fg);font-weight:600">0</td>
  <td style="color:var(--red-fg);font-weight:600">0</td>
  <td>—</td>
</tr><tr>
  <td><span class="badge badge-medium">medium</span></td>
  <td>0</td>
  <td style="color:var(--green-fg);font-weight:600">0</td>
  <td style="color:var(--red-fg);font-weight:600">0</td>
  <td>—</td>
</tr><tr>
  <td><span class="badge badge-hard">hard</span></td>
  <td>1</td>
  <td style="color:var(--green-fg);font-weight:600">1</td>
  <td style="color:var(--red-fg);font-weight:600">0</td>
  <td>100%</td>
</tr></tbody>
  </table>
</div>

<div class="section">
  <div class="section-title">Questions (1)</div>
  <details class="q-accordion q-ok">
  <summary>
    <span class="q-id">Q10</span>
    <span class="q-text">Using the transactions list, perform the following steps in order: STEP 1 - for every transaction compute the Haversine distance in kilometres between the cardholder location (lat, long) and the merchant location (merch_lat, merch_long) using the formula: a = sin((phi2-phi1)/2)^2 + cos(phi1)*cos(phi2)*sin((lam2-lam1)/2)^2, distance_km = 2 * R * asin(sqrt(a)) where R=6371 and all angles are in radians (use math.radians, math.sin, math.cos, math.asin, math.sqrt); STEP 2 - assign each transaction to a distance band based on its distance_km: &#x27;0-10km&#x27; if distance_km &lt; 10, &#x27;10-50km&#x27; if 10 &lt;= distance_km &lt; 50, &#x27;50-200km&#x27; if 50 &lt;= distance_km &lt; 200, &#x27;200+km&#x27; if distance_km &gt;= 200; STEP 3 - group transactions by (category, distance_band) and for each group accumulate: total_count, fraud_count (sum of is_fraud), amt_sum (sum of amt); STEP 4 - keep only groups where total_count &gt;= 20, then for each kept group compute fraud_rate = fraud_count / total_count and avg_amt = amt_sum / total_count, rounding fraud_rate to 6 decimal places and avg_amt to 2 decimal places; STEP 5 - sort the kept groups by fraud_rate descending and take the top 3; STEP 6 - return the top 3 as a list of [category, distance_band, fraud_rate, total_count, avg_amt] sorted by fraud_rate descending.</span>
    <span class="badge badge-hard">hard</span>
    <span class="badge badge-ok">✓ PASSED</span>
    <span class="q-iters">1 iteration</span>
  </summary>
  <div class="q-body">
    <div class="answer-box ok"><strong>Answer:</strong> [
  [
    &quot;misc_net&quot;,
    &quot;10-50km&quot;,
    0.5,
    66,
    435.85
  ],
  [
    &quot;grocery_pos&quot;,
    &quot;10-50km&quot;,
    0.415929,
    113,
    189.28
  ],
  [
    &quot;shopping_net&quot;,
    &quot;50-200km&quot;,
    0.414458,
    415,
    469.43
  ]
] &nbsp; <span style='color:var(--gray-500);font-size:0.8rem'>(31.0ms)</span></div>
    
    <details class="iter-block iter-ok" open>
  <summary>
    Iteration 1 &nbsp;
    <span class="badge badge-iter-ok">APPROVED ✓</span>
  </summary>
  <div class="iter-body">
    <div class="critic-block">
  <div class="critic-reasoning">DAG is valid and approved for execution.</div>
  
  
</div>
    <div class="dag-section"><div class="dag-description">Compute Haversine distance for each transaction, categorize into distance bands, group by category and distance band, filter and compute statistics, and return top 3 groups by fraud rate.</div>
<div class="dag-svg-wrap"><div class="dag-svg-title">DAG Structure</div><svg xmlns="http://www.w3.org/2000/svg" width="1378" height="124" style="max-width:100%;display:block;overflow:visible;">
<defs><marker id="dag-arrow" markerWidth="9" markerHeight="7" refX="9" refY="3.5" orient="auto"><polygon points="0 0, 9 3.5, 0 7" fill="#94a3b8"/></marker></defs>
<path d="M234.0,62.0 C269.0,62.0 269.0,62.0 304.0,62.0" fill="none" stroke="#94a3b8" stroke-width="1.8" marker-end="url(#dag-arrow)"/>
<path d="M514.0,62.0 C549.0,62.0 549.0,62.0 584.0,62.0" fill="none" stroke="#94a3b8" stroke-width="1.8" marker-end="url(#dag-arrow)"/>
<path d="M794.0,62.0 C829.0,62.0 829.0,62.0 864.0,62.0" fill="none" stroke="#94a3b8" stroke-width="1.8" marker-end="url(#dag-arrow)"/>
<path d="M1074.0,62.0 C1109.0,62.0 1109.0,62.0 1144.0,62.0" fill="none" stroke="#94a3b8" stroke-width="1.8" marker-end="url(#dag-arrow)"/>
<rect x="24" y="24" width="210" height="76" rx="6" ry="6" fill="white" stroke="#3b82f6" stroke-width="1.8"/>
<rect x="24" y="24" width="210" height="22" rx="6" ry="6" fill="#3b82f6"/>
<rect x="24" y="40" width="210" height="6" fill="#3b82f6"/>
<text x="32" y="39" font-family="monospace" font-size="12" fill="white" font-weight="bold">step_1a</text>
<text x="32" y="62" font-family="system-ui,sans-serif" font-size="11" fill="#374151">Compute Haversine distance f</text>
<text x="32" y="76" font-family="system-ui,sans-serif" font-size="11" fill="#374151">or each transaction</text>
<text x="32" y="94" font-family="monospace" font-size="10" fill="#3b82f6">Layer 0</text>
<rect x="304" y="24" width="210" height="76" rx="6" ry="6" fill="white" stroke="#0d9488" stroke-width="1.8"/>
<rect x="304" y="24" width="210" height="22" rx="6" ry="6" fill="#0d9488"/>
<rect x="304" y="40" width="210" height="6" fill="#0d9488"/>
<text x="312" y="39" font-family="monospace" font-size="12" fill="white" font-weight="bold">step_2a</text>
<text x="312" y="62" font-family="system-ui,sans-serif" font-size="11" fill="#374151">Assign distance band to each</text>
<text x="312" y="76" font-family="system-ui,sans-serif" font-size="11" fill="#374151"> transaction</text>
<text x="312" y="94" font-family="monospace" font-size="10" fill="#0d9488">Layer 1</text>
<rect x="584" y="24" width="210" height="76" rx="6" ry="6" fill="white" stroke="#7c3aed" stroke-width="1.8"/>
<rect x="584" y="24" width="210" height="22" rx="6" ry="6" fill="#7c3aed"/>
<rect x="584" y="40" width="210" height="6" fill="#7c3aed"/>
<text x="592" y="39" font-family="monospace" font-size="12" fill="white" font-weight="bold">step_3a</text>
<text x="592" y="62" font-family="system-ui,sans-serif" font-size="11" fill="#374151">Group transactions by (categ</text>
<text x="592" y="76" font-family="system-ui,sans-serif" font-size="11" fill="#374151">ory, distance_band) and acc…</text>
<text x="592" y="94" font-family="monospace" font-size="10" fill="#7c3aed">Layer 2</text>
<rect x="864" y="24" width="210" height="76" rx="6" ry="6" fill="white" stroke="#d97706" stroke-width="1.8"/>
<rect x="864" y="24" width="210" height="22" rx="6" ry="6" fill="#d97706"/>
<rect x="864" y="40" width="210" height="6" fill="#d97706"/>
<text x="872" y="39" font-family="monospace" font-size="12" fill="white" font-weight="bold">step_4a</text>
<text x="872" y="62" font-family="system-ui,sans-serif" font-size="11" fill="#374151">Filter groups with total_cou</text>
<text x="872" y="76" font-family="system-ui,sans-serif" font-size="11" fill="#374151">nt &gt;= 20 and compute fraud_…</text>
<text x="872" y="94" font-family="monospace" font-size="10" fill="#d97706">Layer 3</text>
<rect x="1144" y="24" width="210" height="76" rx="6" ry="6" fill="white" stroke="#dc2626" stroke-width="1.8"/>
<rect x="1144" y="24" width="210" height="22" rx="6" ry="6" fill="#dc2626"/>
<rect x="1144" y="40" width="210" height="6" fill="#dc2626"/>
<text x="1152" y="39" font-family="monospace" font-size="12" fill="white" font-weight="bold">step_5a</text>
<text x="1152" y="62" font-family="system-ui,sans-serif" font-size="11" fill="#374151">Sort groups by fraud_rate de</text>
<text x="1152" y="76" font-family="system-ui,sans-serif" font-size="11" fill="#374151">scending and take top 3</text>
<text x="1152" y="94" font-family="monospace" font-size="10" fill="#dc2626">Layer 4</text>
</svg></div>
<div class="dag-node">
  <div class="dag-node-header">
    <span class="node-id">step_1a</span>
    <span class="badge badge-layer">Layer 0</span>
    <span class="output-type">→ list[dict]</span>
  </div>
  <div class="dag-node-operation">Compute Haversine distance for each transaction</div>
  <div class="dag-node-inputs">
  <strong>Inputs:</strong>
  <ul><li><code>transactions</code> ← <code>dataset.transactions</code></li></ul>
</div>
  <pre class="code-block"><code><span class="hl-kw">def</span> compute_haversine_distance(transactions):
    R = 6371  <span class="hl-cm"># Earth radius in kilometers</span>
    result = []
    <span class="hl-kw">for</span> transaction <span class="hl-kw">in</span> transactions:
        lat1, lon1 = <span class="hl-bi">map</span>(math.radians, [transaction[<span <span class="hl-kw">class</span>="hl-st">&#x27;lat&#x27;</span>], transaction[<span <span class="hl-kw">class</span>="hl-st">&#x27;long&#x27;</span>]])
        lat2, lon2 = <span class="hl-bi">map</span>(math.radians, [transaction[<span <span class="hl-kw">class</span>="hl-st">&#x27;merch_lat&#x27;</span>], transaction[<span <span class="hl-kw">class</span>="hl-st">&#x27;merch_long&#x27;</span>]])
        dlat = lat2 - lat1
        dlon = lon2 - lon1
        a = math.sin(dlat / 2) ** 2 + math.cos(lat1) * math.cos(lat2) * math.sin(dlon / 2) ** 2
        distance_km = 2 * R * math.asin(math.sqrt(a))
        transaction[<span <span class="hl-kw">class</span>="hl-st">&#x27;distance_km&#x27;</span>] = distance_km
        result.append(transaction)
    <span class="hl-kw">return</span> result</code></pre>
</div>
<div class="dag-node">
  <div class="dag-node-header">
    <span class="node-id">step_2a</span>
    <span class="badge badge-layer">Layer 1</span>
    <span class="output-type">→ list[dict]</span>
  </div>
  <div class="dag-node-operation">Assign distance band to each transaction</div>
  <div class="dag-node-inputs">
  <strong>Inputs:</strong>
  <ul><li><code>transactions</code> ← <code>prev_node.step_1a.output</code></li></ul>
</div>
  <pre class="code-block"><code><span class="hl-kw">def</span> assign_distance_band(transactions):
    <span class="hl-kw">for</span> transaction <span class="hl-kw">in</span> transactions:
        distance_km = transaction[<span <span class="hl-kw">class</span>="hl-st">&#x27;distance_km&#x27;</span>]
        <span class="hl-kw">if</span> distance_km &lt; 10:
            transaction[<span <span class="hl-kw">class</span>="hl-st">&#x27;distance_band&#x27;</span>] = <span <span class="hl-kw">class</span>="hl-st">&#x27;0-10km&#x27;</span>
        <span class="hl-kw">elif</span> distance_km &lt; 50:
            transaction[<span <span class="hl-kw">class</span>="hl-st">&#x27;distance_band&#x27;</span>] = <span <span class="hl-kw">class</span>="hl-st">&#x27;10-50km&#x27;</span>
        <span class="hl-kw">elif</span> distance_km &lt; 200:
            transaction[<span <span class="hl-kw">class</span>="hl-st">&#x27;distance_band&#x27;</span>] = <span <span class="hl-kw">class</span>="hl-st">&#x27;50-200km&#x27;</span>
        <span class="hl-kw">else</span>:
            transaction[<span <span class="hl-kw">class</span>="hl-st">&#x27;distance_band&#x27;</span>] = <span <span class="hl-kw">class</span>="hl-st">&#x27;200+km&#x27;</span>
    <span class="hl-kw">return</span> transactions</code></pre>
</div>
<div class="dag-node">
  <div class="dag-node-header">
    <span class="node-id">step_3a</span>
    <span class="badge badge-layer">Layer 2</span>
    <span class="output-type">→ dict[tuple, dict]</span>
  </div>
  <div class="dag-node-operation">Group transactions by (category, distance_band) and accumulate statistics</div>
  <div class="dag-node-inputs">
  <strong>Inputs:</strong>
  <ul><li><code>transactions</code> ← <code>prev_node.step_2a.output</code></li></ul>
</div>
  <pre class="code-block"><code><span class="hl-kw">def</span> group_and_accumulate(transactions):
    grouped_data = defaultdict(<span class="hl-kw">lambda</span>: {<span <span class="hl-kw">class</span>="hl-st">&#x27;total_count&#x27;</span>: 0, <span <span class="hl-kw">class</span>="hl-st">&#x27;fraud_count&#x27;</span>: 0, <span <span class="hl-kw">class</span>="hl-st">&#x27;amt_sum&#x27;</span>: 0.0})
    <span class="hl-kw">for</span> transaction <span class="hl-kw">in</span> transactions:
        key = (transaction[<span <span class="hl-kw">class</span>="hl-st">&#x27;category&#x27;</span>], transaction[<span <span class="hl-kw">class</span>="hl-st">&#x27;distance_band&#x27;</span>])
        grouped_data[key][<span <span class="hl-kw">class</span>="hl-st">&#x27;total_count&#x27;</span>] += 1
        grouped_data[key][<span <span class="hl-kw">class</span>="hl-st">&#x27;fraud_count&#x27;</span>] += transaction[<span <span class="hl-kw">class</span>="hl-st">&#x27;is_fraud&#x27;</span>]
        grouped_data[key][<span <span class="hl-kw">class</span>="hl-st">&#x27;amt_sum&#x27;</span>] += transaction[<span <span class="hl-kw">class</span>="hl-st">&#x27;amt&#x27;</span>]
    <span class="hl-kw">return</span> grouped_data</code></pre>
</div>
<div class="dag-node">
  <div class="dag-node-header">
    <span class="node-id">step_4a</span>
    <span class="badge badge-layer">Layer 3</span>
    <span class="output-type">→ list[tuple]</span>
  </div>
  <div class="dag-node-operation">Filter groups with total_count &gt;= 20 and compute fraud_rate and avg_amt</div>
  <div class="dag-node-inputs">
  <strong>Inputs:</strong>
  <ul><li><code>grouped_data</code> ← <code>prev_node.step_3a.output</code></li></ul>
</div>
  <pre class="code-block"><code><span class="hl-kw">def</span> filter_and_compute_statistics(grouped_data):
    result = []
    <span class="hl-kw">for</span> (category, distance_band), data <span class="hl-kw">in</span> grouped_data.items():
        <span class="hl-kw">if</span> data[<span <span class="hl-kw">class</span>="hl-st">&#x27;total_count&#x27;</span>] &gt;= 20:
            fraud_rate = <span class="hl-bi">round</span>(data[<span <span class="hl-kw">class</span>="hl-st">&#x27;fraud_count&#x27;</span>] / data[<span <span class="hl-kw">class</span>="hl-st">&#x27;total_count&#x27;</span>], 6)
            avg_amt = <span class="hl-bi">round</span>(data[<span <span class="hl-kw">class</span>="hl-st">&#x27;amt_sum&#x27;</span>] / data[<span <span class="hl-kw">class</span>="hl-st">&#x27;total_count&#x27;</span>], 2)
            result.append((category, distance_band, fraud_rate, data[<span <span class="hl-kw">class</span>="hl-st">&#x27;total_count&#x27;</span>], avg_amt))
    <span class="hl-kw">return</span> result</code></pre>
</div>
<div class="dag-node">
  <div class="dag-node-header">
    <span class="node-id">step_5a</span>
    <span class="badge badge-layer">Layer 4</span>
    <span class="output-type">→ list[tuple]</span>
  </div>
  <div class="dag-node-operation">Sort groups by fraud_rate descending and take top 3</div>
  <div class="dag-node-inputs">
  <strong>Inputs:</strong>
  <ul><li><code>filtered_groups</code> ← <code>prev_node.step_4a.output</code></li></ul>
</div>
  <pre class="code-block"><code><span class="hl-kw">def</span> sort_and_select_top_3(filtered_groups):
    sorted_groups = <span class="hl-bi">sorted</span>(filtered_groups, key=<span class="hl-kw">lambda</span> x: x[2], reverse=<span class="hl-kw">True</span>)
    <span class="hl-kw">return</span> sorted_groups[:3]</code></pre>
</div>
<div class="edges-row"><span class="edge-item">step_1a → step_2a</span><span class="edge-item">step_2a → step_3a</span><span class="edge-item">step_3a → step_4a</span><span class="edge-item">step_4a → step_5a</span></div>
<div class="final-node-label">Final Answer Node: <code>step_5a</code></div></div>
  </div>
</details>
    <div class="outputs-section">
  <strong>Node Outputs</strong>
  <table class="outputs-table">
    <thead><tr><th>Node</th><th>Output</th></tr></thead>
    <tbody><tr>
  <td>step_1a</td>
  <td><pre>[
  {
    &quot;trans_date_trans_time&quot;: &quot;01-05-2019 13:53&quot;,
    &quot;cc_num&quot;: &quot;4585130000000.0&quot;,
    &quot;merchant&quot;: &quot;fraud_Fadel-Hilpert&quot;,
    &quot;category&quot;: &quot;health_fitness&quot;,
    &quot;amt&quot;: 13.73,
    &quot;first&quot;: &quot;Karen&quot;,
    &quot;last&quot;: &quot;Gordon&quot;,
    &quot;gender&quot;: &quot;F&quot;,
    &quot;city&quot;: &quot;Utica&quot;,
    &quot;state&quot;: &quot;MO&quot;,
    &quot;zip&quot;: &quot;64686&quot;,
    &quot;lat&quot;: 39.7417,
    &quot;long&quot;: -93.6289,
    &quot;city_pop&quot;: 271,
    &quot;job&quot;: &quot;Land/geomatics surveyor&quot;,
    &quot;dob&quot;: &quot;18-04-1972&quot;,
    &quot;trans_num&quot;: &quot;141c2a6cddba22f3defbf9f812f3abdc&quot;,
    &quot;unix_time&quot;: 1335880406,
    &quot;merch_lat&quot;: 39.571624,
    &quot;merch_long&quot;: -93.837554,
    &quot;is_fraud&quot;: 0,
    &quot;merch_zipcode&quot;: &quot;64624.0&quot;,
    &quot;distance_km&quot;: 26.013597229321498,
    &quot;distance_band&quot;: &quot;10-50km&quot;
  },
  {
    &quot;trans_date_trans_time&quot;: &quot;12-01-2019 01:22&quot;,
    &quot;cc_num&quot;: &quot;4777070000000000.0&quot;,
    &quot;merchant&quot;: &quot;fraud_Padberg-Welch&quot;,
    &quot;category&quot;: &quot;grocery_pos&quot;,
    &quot;amt&quot;: 90.42,
    &quot;first&quot;: &quot;Peter&quot;,
    &quot;last&quot;: &quot;Caldwell&quot;,
    &quot;gender&quot;: &quot;M&quot;,
    &quot;city&quot;: &quot;Oaks&quot;,
    &quot;state&quot;: &quot;PA&quot;,
    &quot;zip&quot;: &quot;19456&quot;,
    &quot;lat&quot;: 40.1334,
    &quot;long&quot;: -75.4536,
    &quot;city_pop&quot;: 737,
    &quot;job&quot;: &quot;Oceanographer&quot;,
    &quot;dob&quot;: &quot;24-04-1987&quot;,
    &quot;trans_num&quot;: &quot;a5c91a15a293067cbb32b267c935ab49&quot;,
    &quot;unix_time&quot;: 1326331341,
    &quot;merch_lat&quot;: 40.958897,
    &quot;merch_long&quot;: -75.076606,
    &quot;is_fraud&quot;: 0,
    &quot;merch_zipcode&quot;: &quot;7832.0&quot;,
    &quot;distance_km&quot;: 97.16085043414986,
    &quot;distance_band&quot;: &quot;50-200km&quot;
  },
  {
    &quot;trans_date_trans_time&quot;: &quot;05-05-2019 19:04&quot;,
    &quot;cc_num&quot;: &quot;4178100000000000.0&quot;,
    &quot;merchant&quot;: &quot;fraud_Langworth LLC&quot;,
    &quot;category&quot;: &quot;personal_care&quot;,
    &quot;amt&quot;: 100.68,
    &quot;first&quot;: &quot;Jill&quot;,
    &quot;last&quot;: &quot;Flores&quot;,
    &quot;gender&quot;: &quot;F&quot;,
    &quot;city&quot;: &quot;Baroda&quot;,
    &quot;state&quot;: &quot;MI&quot;,
    &quot;zip&quot;: &quot;49101&quot;,
    &quot;lat&quot;: 41.9488,
    &quot;long&quot;: -86.4913,
    &quot;city_pop&quot;: 3104,
    &quot;job&quot;: &quot;Horticulturist, commercial&quot;,
    &quot;dob&quot;: &quot;29-03-1981&quot;,
    &quot;trans_num&quot;: &quot;5956f0e95bcb3bee690131e5593c0fb9&quot;,
    &quot;unix_time&quot;: 1336244642,
    &quot;merch_lat&quot;: 41.01468,
    &quot;merch_long&quot;: -85.66665,
    &quot;is_fraud&quot;: 0,
    &quot;merch_zipcode&quot;: &quot;46787.0&quot;,
    &quot;distance_km&quot;: 124.52969979082017,
    &quot;distance_band&quot;: &quot;50-200km&quot;
  },
  {
    &quot;trans_date_trans_time&quot;: &quot;04-10-2019 17:41&quot;,
    &quot;cc_num&quot;: &quot;379141000000000.0&quot;,
    &quot;merchant&quot;: &quot;fraud_Schoen, Nienow and Bauch&quot;,
    &quot;category&quot;: &quot;personal_care&quot;,
    &quot;amt&quot;: 36.18,
    &quot;first&quot;: &quot;Gerald&quot;,
    &quot;last&quot;: &quot;Anthony&quot;,
    &quot;gender&quot;: &quot;M&quot;,
    &quot;city&quot;: &quot;Monetta&quot;,
    &quot;state&quot;: &quot;SC&quot;,
    &quot;zip&quot;: &quot;29105&quot;,
    &quot;lat&quot;: 33.8084,
    &quot;long&quot;: -81.5956,
    &quot;city_pop&quot;: 1514,
    &quot;job&quot;: &quot;Chief Strategy Officer&quot;,
    &quot;dob&quot;: &quot;15-12-1966&quot;,
    &quot;trans_num&quot;: &quot;cef0948db3aa85e0cb6ee05f942802f6&quot;,
    &quot;unix_time&quot;: 1349372476,
    &quot;merch_lat&quot;: 32.948689,
    &quot;merch_long&quot;: -80.755234,
    &quot;is_fraud&quot;: 0,
    &quot;merch_zipcode&quot;: &quot;29475.0&quot;,
    &quot;distance_km&quot;: 123.39798776499151,
    &quot;distance_band&quot;: &quot;50-200km&quot;
  },
  {
    &quot;trans_date_trans_time&quot;: &quot;13-01-2019 00:49&quot;,
    &quot;cc_num&quot;: &quot;180031000000000.0&quot;,
    &quot;merchant&quot;: &quot;fraud_Hermann and Sons&quot;,
    &quot;category&quot;: &quot;shopping_pos&quot;,
    &quot;amt&quot;: 952.08,
    &quot;first&quot;: &quot;Becky&quot;,
    &quot;last&quot;: &quot;Mckinney&quot;,
    &quot;gender&quot;: &quot;F&quot;,
    &quot;city&quot;: &quot;Mobile&quot;,
    &quot;state&quot;: &quot;AL&quot;,
    &quot;zip&quot;: &quot;36617&quot;,
    &quot;lat&quot;: 30.7145,
    &quot;long&quot;: -88.0918,
    &quot;city_pop&quot;: 270712,
    &quot;job&quot;: &quot;Surveyor, land/geomatics&quot;,
    &quot;dob&quot;: &quot;05-01-1972&quot;,
    &quot;trans_num&quot;: &quot;7eb9b1814acf9db55a170d8d9e5497ee&quot;,
    &quot;unix_time&quot;: 1326415744,
    &quot;merch_lat&quot;: 30.803533,
    &quot;merch_long&quot;: -88.140115,
    &quot;is_fraud&quot;: 1,
    &quot;merch_zipcode&quot;: &quot;36613.0&quot;,
    &quot;distance_km&quot;: 10.923534186416232,
    &quot;distance_band&quot;: &quot;10-50km&quot;
  },
  {
    &quot;trans_date_trans_time&quot;: &quot;25-08-2019 22:03&quot;,
    &quot;cc_num&quot;: &quot;4128030000000000.0&quot;,
    &quot;merchant&quot;: &quot;fraud_Towne, Greenholt and Koepp&quot;,
    &quot;category&quot;: &quot;shopping_net&quot;,
    &quot;amt&quot;: 1170.79,
    &quot;first&quot;: &quot;Kyle&quot;,
    &quot;last&quot;: &quot;Park&quot;,
    &quot;gender&quot;: &quot;M&quot;,
    &quot;city&quot;: &quot;Mount Perry&quot;,
    &quot;state&quot;: &quot;OH&quot;,
    &quot;zip&quot;: &quot;43760&quot;,
    &quot;lat&quot;: 39.8788,
    &quot;long&quot;: -82.188,
    &quot;city_pop&quot;: 1831,
    &quot;job&quot;: &quot;Barrister&#x27;s clerk&quot;,
    &quot;dob&quot;: &quot;18-10-1953&quot;,
    &quot;trans_num&quot;: &quot;e72bd8d705e7f6d883734eec6fe8735a&quot;,
    &quot;unix_time&quot;: 1345932213,
    &quot;merch_lat&quot;: 40.695312,
    &quot;merch_long&quot;: -81.220764,
    &quot;is_fraud&quot;: 1,
    &quot;merch_zipcode&quot;: &quot;44644.0&quot;,
    &quot;distance_km&quot;: 122.36687428452254,
    &quot;distance_band&quot;: &quot;50-200km&quot;
  },
  {
    &quot;trans_date_trans_time&quot;: &quot;28-04-2019 22:07&quot;,
    &quot;cc_num&quot;: &quot;30371000000000.0&quot;,
    &quot;merchant&quot;: &quot;fraud_Huel, Hammes and Witting&quot;,
    &quot;category&quot;: &quot;grocery_pos&quot;,
    &quot;amt&quot;: 348.41,
    &quot;first&quot;: &quot;Robert&quot;,
    &quot;last&quot;: &quot;James&quot;,
    &quot;gender&quot;: &quot;M&quot;,
    &quot;city&quot;: &quot;Tamaroa&quot;,
    &quot;state&quot;: &quot;IL&quot;,
    &quot;zip&quot;: &quot;62888&quot;,
    &quot;lat&quot;: 38.138,
    &quot;long&quot;: -89.2231,
    &quot;city_pop&quot;: 2135,
    &quot;job&quot;: &quot;Development worker, community&quot;,
    &quot;dob&quot;: &quot;31-01-1961&quot;,
    &quot;trans_num&quot;: &quot;149e59d9c5aac7b21310dd13b48789a8&quot;,
    &quot;unix_time&quot;: 1335650847,
    &quot;merch_lat&quot;: 38.162793,
    &quot;merch_long&quot;: -89.351823,
    &quot;is_fraud&quot;: 1,
    &quot;merch_zipcode&quot;: &quot;62274.0&quot;,
    &quot;distance_km&quot;: 11.588593487782179,
    &quot;distance_band&quot;: &quot;10-50km&quot;
  },
  {
    &quot;trans_date_trans_time&quot;: &quot;10-03-2020 01:41&quot;,
    &quot;cc_num&quot;: &quot;5596350000000000.0&quot;,
    &quot;merchant&quot;: &quot;fraud_Daugherty, Pouros and Beahan&quot;,
    &quot;category&quot;: &quot;shopping_pos&quot;,
    &quot;amt&quot;: 71.84,
    &quot;first&quot;: &quot;Joseph&quot;,
    &quot;last&quot;: &quot;Moody&quot;,
    &quot;gender&quot;: &quot;M&quot;,
    &quot;city&quot;: &quot;Kenner&quot;,
    &quot;state&quot;: &quot;LA&quot;,
    &quot;zip&quot;: &quot;70062&quot;,
    &quot;lat&quot;: 29.9912,
    &quot;long&quot;: -90.2479,
    &quot;city_pop&quot;: 68211,
    &quot;job&quot;: &quot;Engineer, petroleum&quot;,
    &quot;dob&quot;: &quot;23-04-1941&quot;,
    &quot;trans_num&quot;: &quot;35869ae2d6198f227ccd37f2b8116491&quot;,
    &quot;unix_time&quot;: 1362879662,
    &quot;merch_lat&quot;: 30.264585,
    &quot;merch_long&quot;: -89.971485,
    &quot;is_fraud&quot;: 0,
    &quot;merch_zipcode&quot;: &quot;70445.0&quot;,
    &quot;distance_km&quot;: 40.38307701368193,
    &quot;distance_band&quot;: &quot;10-50km&quot;
  },
  {
    &quot;trans_date_trans_time&quot;: &quot;12-10-2019 16:56&quot;,
    &quot;cc_num&quot;: &quot;4220350000000.0&quot;,
    &quot;merchant&quot;: &quot;fraud_Bode-Rempel&quot;,
    &quot;category&quot;: &quot;kids_pets&quot;,
    &quot;amt&quot;: 83.18,
    &quot;first&quot;: &quot;Patrick&quot;,
    &quot;last&quot;: &quot;Torres&quot;,
    &quot;gender&quot;: &quot;M&quot;,
    &quot;city&quot;: &quot;Oxford&quot;,
    &quot;state&quot;: &quot;MI&quot;,
    &quot;zip&quot;: &quot;48371&quot;,
    &quot;lat&quot;: 42.8223,
    &quot;long&quot;: -83.2829,
    &quot;city_pop&quot;: 24840,
    &quot;job&quot;: &quot;Agricultural consultant&quot;,
    &quot;dob&quot;: &quot;20-01-1960&quot;,
    &quot;trans_num&quot;: &quot;aa8e752d519b298085787e341b08c093&quot;,
    &quot;unix_time&quot;: 1350061009,
    &quot;merch_lat&quot;: 42.42825,
    &quot;merch_long&quot;: -83.761996,
    &quot;is_fraud&quot;: 0,
    &quot;merch_zipcode&quot;: &quot;48189.0&quot;,
    &quot;distance_km&quot;: 58.79071824330335,
    &quot;distance_band&quot;: &quot;50-200km&quot;
  },
  {
    &quot;trans_date_trans_time&quot;: &quot;21-06-2019 07:05&quot;,
    &quot;cc_num&quot;: &quot;4.22371e+18&quot;,
    &quot;merchant&quot;: &quot;fraud_Padberg-Welch&quot;,
    &quot;category&quot;: &quot;grocery_pos&quot;,
    &quot;amt&quot;: 109.08,
    &quot;first&quot;: &quot;Adam&quot;,
    &quot;last&quot;: &quot;Riddle&quot;,
    &quot;gender&quot;: &quot;M&quot;,
    &quot;city&quot;: &quot;Mount Saint Joseph&quot;,
    &quot;state&quot;: &quot;OH&quot;,
    &quot;zip&quot;: &quot;45051&quot;,
    &quot;lat&quot;: 39.0965,
    &quot;long&quot;: -84.6431,
    &quot;city_pop&quot;: 177,
    &quot;job&quot;: &quot;Exhibition designer&quot;,
    &quot;dob&quot;: &quot;30-05-1974&quot;,
    &quot;trans_num&quot;: &quot;269ccb4cd0f1233c86f735b113ec7a0f&quot;,
    &quot;unix_time&quot;: 1340262327,
    &quot;merch_lat&quot;: 39.071911,
    &quot;merch_long&quot;: -84.604047,
    &quot;is_fraud&quot;: 0,
    &quot;merch_zipcode&quot;: &quot;45238.0&quot;,
    &quot;distance_km&quot;: 4.3402230406535365,
    &quot;distance_band&quot;: &quot;0-10km&quot;
  }
]
... (5000 total items)</pre></td>
</tr><tr>
  <td>step_2a</td>
  <td><pre>[
  {
    &quot;trans_date_trans_time&quot;: &quot;01-05-2019 13:53&quot;,
    &quot;cc_num&quot;: &quot;4585130000000.0&quot;,
    &quot;merchant&quot;: &quot;fraud_Fadel-Hilpert&quot;,
    &quot;category&quot;: &quot;health_fitness&quot;,
    &quot;amt&quot;: 13.73,
    &quot;first&quot;: &quot;Karen&quot;,
    &quot;last&quot;: &quot;Gordon&quot;,
    &quot;gender&quot;: &quot;F&quot;,
    &quot;city&quot;: &quot;Utica&quot;,
    &quot;state&quot;: &quot;MO&quot;,
    &quot;zip&quot;: &quot;64686&quot;,
    &quot;lat&quot;: 39.7417,
    &quot;long&quot;: -93.6289,
    &quot;city_pop&quot;: 271,
    &quot;job&quot;: &quot;Land/geomatics surveyor&quot;,
    &quot;dob&quot;: &quot;18-04-1972&quot;,
    &quot;trans_num&quot;: &quot;141c2a6cddba22f3defbf9f812f3abdc&quot;,
    &quot;unix_time&quot;: 1335880406,
    &quot;merch_lat&quot;: 39.571624,
    &quot;merch_long&quot;: -93.837554,
    &quot;is_fraud&quot;: 0,
    &quot;merch_zipcode&quot;: &quot;64624.0&quot;,
    &quot;distance_km&quot;: 26.013597229321498,
    &quot;distance_band&quot;: &quot;10-50km&quot;
  },
  {
    &quot;trans_date_trans_time&quot;: &quot;12-01-2019 01:22&quot;,
    &quot;cc_num&quot;: &quot;4777070000000000.0&quot;,
    &quot;merchant&quot;: &quot;fraud_Padberg-Welch&quot;,
    &quot;category&quot;: &quot;grocery_pos&quot;,
    &quot;amt&quot;: 90.42,
    &quot;first&quot;: &quot;Peter&quot;,
    &quot;last&quot;: &quot;Caldwell&quot;,
    &quot;gender&quot;: &quot;M&quot;,
    &quot;city&quot;: &quot;Oaks&quot;,
    &quot;state&quot;: &quot;PA&quot;,
    &quot;zip&quot;: &quot;19456&quot;,
    &quot;lat&quot;: 40.1334,
    &quot;long&quot;: -75.4536,
    &quot;city_pop&quot;: 737,
    &quot;job&quot;: &quot;Oceanographer&quot;,
    &quot;dob&quot;: &quot;24-04-1987&quot;,
    &quot;trans_num&quot;: &quot;a5c91a15a293067cbb32b267c935ab49&quot;,
    &quot;unix_time&quot;: 1326331341,
    &quot;merch_lat&quot;: 40.958897,
    &quot;merch_long&quot;: -75.076606,
    &quot;is_fraud&quot;: 0,
    &quot;merch_zipcode&quot;: &quot;7832.0&quot;,
    &quot;distance_km&quot;: 97.16085043414986,
    &quot;distance_band&quot;: &quot;50-200km&quot;
  },
  {
    &quot;trans_date_trans_time&quot;: &quot;05-05-2019 19:04&quot;,
    &quot;cc_num&quot;: &quot;4178100000000000.0&quot;,
    &quot;merchant&quot;: &quot;fraud_Langworth LLC&quot;,
    &quot;category&quot;: &quot;personal_care&quot;,
    &quot;amt&quot;: 100.68,
    &quot;first&quot;: &quot;Jill&quot;,
    &quot;last&quot;: &quot;Flores&quot;,
    &quot;gender&quot;: &quot;F&quot;,
    &quot;city&quot;: &quot;Baroda&quot;,
    &quot;state&quot;: &quot;MI&quot;,
    &quot;zip&quot;: &quot;49101&quot;,
    &quot;lat&quot;: 41.9488,
    &quot;long&quot;: -86.4913,
    &quot;city_pop&quot;: 3104,
    &quot;job&quot;: &quot;Horticulturist, commercial&quot;,
    &quot;dob&quot;: &quot;29-03-1981&quot;,
    &quot;trans_num&quot;: &quot;5956f0e95bcb3bee690131e5593c0fb9&quot;,
    &quot;unix_time&quot;: 1336244642,
    &quot;merch_lat&quot;: 41.01468,
    &quot;merch_long&quot;: -85.66665,
    &quot;is_fraud&quot;: 0,
    &quot;merch_zipcode&quot;: &quot;46787.0&quot;,
    &quot;distance_km&quot;: 124.52969979082017,
    &quot;distance_band&quot;: &quot;50-200km&quot;
  },
  {
    &quot;trans_date_trans_time&quot;: &quot;04-10-2019 17:41&quot;,
    &quot;cc_num&quot;: &quot;379141000000000.0&quot;,
    &quot;merchant&quot;: &quot;fraud_Schoen, Nienow and Bauch&quot;,
    &quot;category&quot;: &quot;personal_care&quot;,
    &quot;amt&quot;: 36.18,
    &quot;first&quot;: &quot;Gerald&quot;,
    &quot;last&quot;: &quot;Anthony&quot;,
    &quot;gender&quot;: &quot;M&quot;,
    &quot;city&quot;: &quot;Monetta&quot;,
    &quot;state&quot;: &quot;SC&quot;,
    &quot;zip&quot;: &quot;29105&quot;,
    &quot;lat&quot;: 33.8084,
    &quot;long&quot;: -81.5956,
    &quot;city_pop&quot;: 1514,
    &quot;job&quot;: &quot;Chief Strategy Officer&quot;,
    &quot;dob&quot;: &quot;15-12-1966&quot;,
    &quot;trans_num&quot;: &quot;cef0948db3aa85e0cb6ee05f942802f6&quot;,
    &quot;unix_time&quot;: 1349372476,
    &quot;merch_lat&quot;: 32.948689,
    &quot;merch_long&quot;: -80.755234,
    &quot;is_fraud&quot;: 0,
    &quot;merch_zipcode&quot;: &quot;29475.0&quot;,
    &quot;distance_km&quot;: 123.39798776499151,
    &quot;distance_band&quot;: &quot;50-200km&quot;
  },
  {
    &quot;trans_date_trans_time&quot;: &quot;13-01-2019 00:49&quot;,
    &quot;cc_num&quot;: &quot;180031000000000.0&quot;,
    &quot;merchant&quot;: &quot;fraud_Hermann and Sons&quot;,
    &quot;category&quot;: &quot;shopping_pos&quot;,
    &quot;amt&quot;: 952.08,
    &quot;first&quot;: &quot;Becky&quot;,
    &quot;last&quot;: &quot;Mckinney&quot;,
    &quot;gender&quot;: &quot;F&quot;,
    &quot;city&quot;: &quot;Mobile&quot;,
    &quot;state&quot;: &quot;AL&quot;,
    &quot;zip&quot;: &quot;36617&quot;,
    &quot;lat&quot;: 30.7145,
    &quot;long&quot;: -88.0918,
    &quot;city_pop&quot;: 270712,
    &quot;job&quot;: &quot;Surveyor, land/geomatics&quot;,
    &quot;dob&quot;: &quot;05-01-1972&quot;,
    &quot;trans_num&quot;: &quot;7eb9b1814acf9db55a170d8d9e5497ee&quot;,
    &quot;unix_time&quot;: 1326415744,
    &quot;merch_lat&quot;: 30.803533,
    &quot;merch_long&quot;: -88.140115,
    &quot;is_fraud&quot;: 1,
    &quot;merch_zipcode&quot;: &quot;36613.0&quot;,
    &quot;distance_km&quot;: 10.923534186416232,
    &quot;distance_band&quot;: &quot;10-50km&quot;
  },
  {
    &quot;trans_date_trans_time&quot;: &quot;25-08-2019 22:03&quot;,
    &quot;cc_num&quot;: &quot;4128030000000000.0&quot;,
    &quot;merchant&quot;: &quot;fraud_Towne, Greenholt and Koepp&quot;,
    &quot;category&quot;: &quot;shopping_net&quot;,
    &quot;amt&quot;: 1170.79,
    &quot;first&quot;: &quot;Kyle&quot;,
    &quot;last&quot;: &quot;Park&quot;,
    &quot;gender&quot;: &quot;M&quot;,
    &quot;city&quot;: &quot;Mount Perry&quot;,
    &quot;state&quot;: &quot;OH&quot;,
    &quot;zip&quot;: &quot;43760&quot;,
    &quot;lat&quot;: 39.8788,
    &quot;long&quot;: -82.188,
    &quot;city_pop&quot;: 1831,
    &quot;job&quot;: &quot;Barrister&#x27;s clerk&quot;,
    &quot;dob&quot;: &quot;18-10-1953&quot;,
    &quot;trans_num&quot;: &quot;e72bd8d705e7f6d883734eec6fe8735a&quot;,
    &quot;unix_time&quot;: 1345932213,
    &quot;merch_lat&quot;: 40.695312,
    &quot;merch_long&quot;: -81.220764,
    &quot;is_fraud&quot;: 1,
    &quot;merch_zipcode&quot;: &quot;44644.0&quot;,
    &quot;distance_km&quot;: 122.36687428452254,
    &quot;distance_band&quot;: &quot;50-200km&quot;
  },
  {
    &quot;trans_date_trans_time&quot;: &quot;28-04-2019 22:07&quot;,
    &quot;cc_num&quot;: &quot;30371000000000.0&quot;,
    &quot;merchant&quot;: &quot;fraud_Huel, Hammes and Witting&quot;,
    &quot;category&quot;: &quot;grocery_pos&quot;,
    &quot;amt&quot;: 348.41,
    &quot;first&quot;: &quot;Robert&quot;,
    &quot;last&quot;: &quot;James&quot;,
    &quot;gender&quot;: &quot;M&quot;,
    &quot;city&quot;: &quot;Tamaroa&quot;,
    &quot;state&quot;: &quot;IL&quot;,
    &quot;zip&quot;: &quot;62888&quot;,
    &quot;lat&quot;: 38.138,
    &quot;long&quot;: -89.2231,
    &quot;city_pop&quot;: 2135,
    &quot;job&quot;: &quot;Development worker, community&quot;,
    &quot;dob&quot;: &quot;31-01-1961&quot;,
    &quot;trans_num&quot;: &quot;149e59d9c5aac7b21310dd13b48789a8&quot;,
    &quot;unix_time&quot;: 1335650847,
    &quot;merch_lat&quot;: 38.162793,
    &quot;merch_long&quot;: -89.351823,
    &quot;is_fraud&quot;: 1,
    &quot;merch_zipcode&quot;: &quot;62274.0&quot;,
    &quot;distance_km&quot;: 11.588593487782179,
    &quot;distance_band&quot;: &quot;10-50km&quot;
  },
  {
    &quot;trans_date_trans_time&quot;: &quot;10-03-2020 01:41&quot;,
    &quot;cc_num&quot;: &quot;5596350000000000.0&quot;,
    &quot;merchant&quot;: &quot;fraud_Daugherty, Pouros and Beahan&quot;,
    &quot;category&quot;: &quot;shopping_pos&quot;,
    &quot;amt&quot;: 71.84,
    &quot;first&quot;: &quot;Joseph&quot;,
    &quot;last&quot;: &quot;Moody&quot;,
    &quot;gender&quot;: &quot;M&quot;,
    &quot;city&quot;: &quot;Kenner&quot;,
    &quot;state&quot;: &quot;LA&quot;,
    &quot;zip&quot;: &quot;70062&quot;,
    &quot;lat&quot;: 29.9912,
    &quot;long&quot;: -90.2479,
    &quot;city_pop&quot;: 68211,
    &quot;job&quot;: &quot;Engineer, petroleum&quot;,
    &quot;dob&quot;: &quot;23-04-1941&quot;,
    &quot;trans_num&quot;: &quot;35869ae2d6198f227ccd37f2b8116491&quot;,
    &quot;unix_time&quot;: 1362879662,
    &quot;merch_lat&quot;: 30.264585,
    &quot;merch_long&quot;: -89.971485,
    &quot;is_fraud&quot;: 0,
    &quot;merch_zipcode&quot;: &quot;70445.0&quot;,
    &quot;distance_km&quot;: 40.38307701368193,
    &quot;distance_band&quot;: &quot;10-50km&quot;
  },
  {
    &quot;trans_date_trans_time&quot;: &quot;12-10-2019 16:56&quot;,
    &quot;cc_num&quot;: &quot;4220350000000.0&quot;,
    &quot;merchant&quot;: &quot;fraud_Bode-Rempel&quot;,
    &quot;category&quot;: &quot;kids_pets&quot;,
    &quot;amt&quot;: 83.18,
    &quot;first&quot;: &quot;Patrick&quot;,
    &quot;last&quot;: &quot;Torres&quot;,
    &quot;gender&quot;: &quot;M&quot;,
    &quot;city&quot;: &quot;Oxford&quot;,
    &quot;state&quot;: &quot;MI&quot;,
    &quot;zip&quot;: &quot;48371&quot;,
    &quot;lat&quot;: 42.8223,
    &quot;long&quot;: -83.2829,
    &quot;city_pop&quot;: 24840,
    &quot;job&quot;: &quot;Agricultural consultant&quot;,
    &quot;dob&quot;: &quot;20-01-1960&quot;,
    &quot;trans_num&quot;: &quot;aa8e752d519b298085787e341b08c093&quot;,
    &quot;unix_time&quot;: 1350061009,
    &quot;merch_lat&quot;: 42.42825,
    &quot;merch_long&quot;: -83.761996,
    &quot;is_fraud&quot;: 0,
    &quot;merch_zipcode&quot;: &quot;48189.0&quot;,
    &quot;distance_km&quot;: 58.79071824330335,
    &quot;distance_band&quot;: &quot;50-200km&quot;
  },
  {
    &quot;trans_date_trans_time&quot;: &quot;21-06-2019 07:05&quot;,
    &quot;cc_num&quot;: &quot;4.22371e+18&quot;,
    &quot;merchant&quot;: &quot;fraud_Padberg-Welch&quot;,
    &quot;category&quot;: &quot;grocery_pos&quot;,
    &quot;amt&quot;: 109.08,
    &quot;first&quot;: &quot;Adam&quot;,
    &quot;last&quot;: &quot;Riddle&quot;,
    &quot;gender&quot;: &quot;M&quot;,
    &quot;city&quot;: &quot;Mount Saint Joseph&quot;,
    &quot;state&quot;: &quot;OH&quot;,
    &quot;zip&quot;: &quot;45051&quot;,
    &quot;lat&quot;: 39.0965,
    &quot;long&quot;: -84.6431,
    &quot;city_pop&quot;: 177,
    &quot;job&quot;: &quot;Exhibition designer&quot;,
    &quot;dob&quot;: &quot;30-05-1974&quot;,
    &quot;trans_num&quot;: &quot;269ccb4cd0f1233c86f735b113ec7a0f&quot;,
    &quot;unix_time&quot;: 1340262327,
    &quot;merch_lat&quot;: 39.071911,
    &quot;merch_long&quot;: -84.604047,
    &quot;is_fraud&quot;: 0,
    &quot;merch_zipcode&quot;: &quot;45238.0&quot;,
    &quot;distance_km&quot;: 4.3402230406535365,
    &quot;distance_band&quot;: &quot;0-10km&quot;
  }
]
... (5000 total items)</pre></td>
</tr><tr>
  <td>step_3a</td>
  <td><pre>{
  &quot;(&#x27;health_fitness&#x27;, &#x27;10-50km&#x27;)&quot;: {
    &quot;total_count&quot;: 51,
    &quot;fraud_count&quot;: 0,
    &quot;amt_sum&quot;: 2470.9300000000003
  },
  &quot;(&#x27;grocery_pos&#x27;, &#x27;50-200km&#x27;)&quot;: {
    &quot;total_count&quot;: 480,
    &quot;fraud_count&quot;: 187,
    &quot;amt_sum&quot;: 92245.47000000004
  },
  &quot;(&#x27;personal_care&#x27;, &#x27;50-200km&#x27;)&quot;: {
    &quot;total_count&quot;: 245,
    &quot;fraud_count&quot;: 26,
    &quot;amt_sum&quot;: 10350.639999999989
  },
  &quot;(&#x27;shopping_pos&#x27;, &#x27;10-50km&#x27;)&quot;: {
    &quot;total_count&quot;: 98,
    &quot;fraud_count&quot;: 16,
    &quot;amt_sum&quot;: 17622.090000000004
  },
  &quot;(&#x27;shopping_net&#x27;, &#x27;50-200km&#x27;)&quot;: {
    &quot;total_count&quot;: 415,
    &quot;fraud_count&quot;: 172,
    &quot;amt_sum&quot;: 194813.68000000005
  },
  &quot;(&#x27;grocery_pos&#x27;, &#x27;10-50km&#x27;)&quot;: {
    &quot;total_count&quot;: 113,
    &quot;fraud_count&quot;: 47,
    &quot;amt_sum&quot;: 21388.839999999997
  },
  &quot;(&#x27;kids_pets&#x27;, &#x27;50-200km&#x27;)&quot;: {
    &quot;total_count&quot;: 314,
    &quot;fraud_count&quot;: 33,
    &quot;amt_sum&quot;: 15668.76000000001
  },
  &quot;(&#x27;grocery_pos&#x27;, &#x27;0-10km&#x27;)&quot;: {
    &quot;total_count&quot;: 5,
    &quot;fraud_count&quot;: 2,
    &quot;amt_sum&quot;: 903.62
  },
  &quot;(&#x27;shopping_net&#x27;, &#x27;10-50km&#x27;)&quot;: {
    &quot;total_count&quot;: 103,
    &quot;fraud_count&quot;: 38,
    &quot;amt_sum&quot;: 42628.56999999999
  },
  &quot;(&#x27;shopping_pos&#x27;, &#x27;50-200km&#x27;)&quot;: {
    &quot;total_count&quot;: 386,
    &quot;fraud_count&quot;: 95,
    &quot;amt_sum&quot;: 104737.50000000006
  },
  &quot;(&#x27;gas_transport&#x27;, &#x27;50-200km&#x27;)&quot;: {
    &quot;total_count&quot;: 354,
    &quot;fraud_count&quot;: 58,
    &quot;amt_sum&quot;: 19459.930000000015
  },
  &quot;(&#x27;food_dining&#x27;, &#x27;50-200km&#x27;)&quot;: {
    &quot;total_count&quot;: 243,
    &quot;fraud_count&quot;: 16,
    &quot;amt_sum&quot;: 12320.429999999997
  },
  &quot;(&#x27;health_fitness&#x27;, &#x27;50-200km&#x27;)&quot;: {
    &quot;total_count&quot;: 221,
    &quot;fraud_count&quot;: 13,
    &quot;amt_sum&quot;: 11025.880000000001
  },
  &quot;(&#x27;gas_transport&#x27;, &#x27;10-50km&#x27;)&quot;: {
    &quot;total_count&quot;: 89,
    &quot;fraud_count&quot;: 15,
    &quot;amt_sum&quot;: 5109.550000000003
  },
  &quot;(&#x27;travel&#x27;, &#x27;10-50km&#x27;)&quot;: {
    &quot;total_count&quot;: 34,
    &quot;fraud_count&quot;: 5,
    &quot;amt_sum&quot;: 2149.46
  },
  &quot;(&#x27;entertainment&#x27;, &#x27;50-200km&#x27;)&quot;: {
    &quot;total_count&quot;: 223,
    &quot;fraud_count&quot;: 27,
    &quot;amt_sum&quot;: 25754.78
  },
  &quot;(&#x27;home&#x27;, &#x27;10-50km&#x27;)&quot;: {
    &quot;total_count&quot;: 98,
    &quot;fraud_count&quot;: 6,
    &quot;amt_sum&quot;: 7926.719999999999
  },
  &quot;(&#x27;misc_pos&#x27;, &#x27;50-200km&#x27;)&quot;: {
    &quot;total_count&quot;: 196,
    &quot;fraud_count&quot;: 18,
    &quot;amt_sum&quot;: 12074.870000000004
  },
  &quot;(&#x27;travel&#x27;, &#x27;50-200km&#x27;)&quot;: {
    &quot;total_count&quot;: 121,
    &quot;fraud_count&quot;: 16,
    &quot;amt_sum&quot;: 35736.98
  },
  &quot;(&#x27;home&#x27;, &#x27;50-200km&#x27;)&quot;: {
    &quot;total_count&quot;: 344,
    &quot;fraud_count&quot;: 20,
    &quot;amt_sum&quot;: 24821.479999999996
  }
}
... (41 total keys)</pre></td>
</tr><tr>
  <td>step_4a</td>
  <td><pre>[
  [
    &quot;health_fitness&quot;,
    &quot;10-50km&quot;,
    0.0,
    51,
    48.45
  ],
  [
    &quot;grocery_pos&quot;,
    &quot;50-200km&quot;,
    0.389583,
    480,
    192.18
  ],
  [
    &quot;personal_care&quot;,
    &quot;50-200km&quot;,
    0.106122,
    245,
    42.25
  ],
  [
    &quot;shopping_pos&quot;,
    &quot;10-50km&quot;,
    0.163265,
    98,
    179.82
  ],
  [
    &quot;shopping_net&quot;,
    &quot;50-200km&quot;,
    0.414458,
    415,
    469.43
  ],
  [
    &quot;grocery_pos&quot;,
    &quot;10-50km&quot;,
    0.415929,
    113,
    189.28
  ],
  [
    &quot;kids_pets&quot;,
    &quot;50-200km&quot;,
    0.105096,
    314,
    49.9
  ],
  [
    &quot;shopping_net&quot;,
    &quot;10-50km&quot;,
    0.368932,
    103,
    413.87
  ],
  [
    &quot;shopping_pos&quot;,
    &quot;50-200km&quot;,
    0.246114,
    386,
    271.34
  ],
  [
    &quot;gas_transport&quot;,
    &quot;50-200km&quot;,
    0.163842,
    354,
    54.97
  ]
]
... (28 total items)</pre></td>
</tr><tr>
  <td>step_5a</td>
  <td><pre>[
  [
    &quot;misc_net&quot;,
    &quot;10-50km&quot;,
    0.5,
    66,
    435.85
  ],
  [
    &quot;grocery_pos&quot;,
    &quot;10-50km&quot;,
    0.415929,
    113,
    189.28
  ],
  [
    &quot;shopping_net&quot;,
    &quot;50-200km&quot;,
    0.414458,
    415,
    469.43
  ]
]</pre></td>
</tr></tbody>
  </table>
</div>
  </div>
</details>
</div>
</div>
</body>
</html>